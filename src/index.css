@tailwind base;
@tailwind components;
@tailwind utilities;

/* Tracking Spese - Liquid Glass Design System inspired by Apple Vision OS
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Liquid Glass Background System */
    --background: 220 20% 98%;
    --background-glass: 220 20% 98% / 0.85;
    --background-blur: 220 20% 95% / 0.7;
    --foreground: 220 20% 8%;

    /* Liquid Glass Cards */
    --card: 0 0% 100% / 0.92;
    --card-glass: 220 20% 100% / 0.75;
    --card-foreground: 220 20% 10%;

    /* Popover Glass */
    --popover: 0 0% 100% / 0.96;
    --popover-foreground: 220 20% 10%;

    /* Primary - Apple Blue gradient */
    --primary: 210 100% 50%;
    --primary-light: 210 100% 65%;
    --primary-foreground: 0 0% 100%;
    --primary-glass: 210 100% 50% / 0.9;

    /* Secondary - Soft glass effect */
    --secondary: 220 20% 96% / 0.85;
    --secondary-foreground: 220 20% 15%;

    /* Muted glass surfaces */
    --muted: 220 15% 94% / 0.75;
    --muted-foreground: 220 15% 45%;

    /* Accent - Purple tint for highlights */
    --accent: 250 70% 60%;
    --accent-light: 250 70% 70%;
    --accent-foreground: 0 0% 100%;

    /* Success - Green for income */
    --success: 142 76% 36%;
    --success-light: 142 76% 46%;
    --success-foreground: 0 0% 100%;

    /* Warning - Orange for expenses */
    --warning: 25 95% 53%;
    --warning-light: 25 95% 63%;
    --warning-foreground: 0 0% 100%;

    /* Destructive */
    --destructive: 0 84% 60%;
    --destructive-light: 0 84% 70%;
    --destructive-foreground: 0 0% 100%;

    /* Borders and inputs with liquid glass effect */
    --border: 220 20% 90% / 0.6;
    --border-strong: 220 20% 80%;
    --input: 220 20% 96% / 0.85;
    --ring: 210 100% 50% / 0.25;

    /* Liquid Glass UI specific */
    --glass-background: 220 20% 100% / 0.8;
    --glass-border: 220 20% 100% / 0.25;
    --glass-shadow: 220 20% 0% / 0.08;
    --glass-shadow-hover: 220 20% 0% / 0.12;

    /* Gradients */
    --gradient-primary: linear-gradient(135deg, hsl(210 100% 50%), hsl(210 100% 65%));
    --gradient-glass: linear-gradient(135deg, hsl(220 20% 100% / 0.8), hsl(220 20% 95% / 0.6));
    --gradient-success: linear-gradient(135deg, hsl(142 76% 36%), hsl(142 76% 46%));
    --gradient-warning: linear-gradient(135deg, hsl(25 95% 53%), hsl(25 95% 63%));
    --gradient-background: linear-gradient(135deg, hsl(220 20% 98%), hsl(220 20% 95%));

    --radius: 1.25rem;

    --sidebar-background: 0 0% 98%;

    --sidebar-foreground: 220 15% 26%;

    --sidebar-primary: 220 15% 10%;

    --sidebar-primary-foreground: 0 0% 98%;

    --sidebar-accent: 220 15% 95%;

    --sidebar-accent-foreground: 220 15% 10%;

    --sidebar-border: 220 20% 91%;

    --sidebar-ring: 210 100% 50%;
  }

  .dark {
    /* Dark Liquid Glass UI */
    --background: 220 20% 4%;
    --background-glass: 220 20% 8% / 0.85;
    --background-blur: 220 20% 6% / 0.7;
    --foreground: 220 15% 95%;

    /* Dark Liquid Glass Cards */
    --card: 220 20% 8% / 0.92;
    --card-glass: 220 20% 12% / 0.75;
    --card-foreground: 220 15% 95%;

    /* Dark Popover */
    --popover: 220 20% 6% / 0.96;
    --popover-foreground: 220 15% 95%;

    /* Dark Primary */
    --primary: 210 100% 55%;
    --primary-light: 210 100% 70%;
    --primary-foreground: 0 0% 100%;
    --primary-glass: 210 100% 55% / 0.9;

    /* Dark Secondary */
    --secondary: 220 20% 12% / 0.85;
    --secondary-foreground: 220 15% 85%;

    /* Dark Muted */
    --muted: 220 15% 10% / 0.75;
    --muted-foreground: 220 15% 60%;

    /* Dark Accent */
    --accent: 250 70% 65%;
    --accent-light: 250 70% 75%;
    --accent-foreground: 0 0% 100%;

    /* Dark Success */
    --success: 142 76% 42%;
    --success-light: 142 76% 52%;
    --success-foreground: 0 0% 100%;

    /* Dark Warning */
    --warning: 25 95% 58%;
    --warning-light: 25 95% 68%;
    --warning-foreground: 0 0% 100%;

    /* Dark Destructive */
    --destructive: 0 84% 65%;
    --destructive-light: 0 84% 75%;
    --destructive-foreground: 0 0% 100%;

    /* Dark Borders */
    --border: 220 20% 18% / 0.6;
    --border-strong: 220 20% 25%;
    --input: 220 20% 10% / 0.85;
    --ring: 210 100% 55% / 0.25;

    /* Dark Liquid Glass UI specific */
    --glass-background: 220 20% 8% / 0.8;
    --glass-border: 220 20% 30% / 0.25;
    --glass-shadow: 220 20% 0% / 0.2;
    --glass-shadow-hover: 220 20% 0% / 0.3;

    /* Dark Gradients */
    --gradient-primary: linear-gradient(135deg, hsl(210 100% 55%), hsl(210 100% 70%));
    --gradient-glass: linear-gradient(135deg, hsl(220 20% 12% / 0.8), hsl(220 20% 8% / 0.6));
    --gradient-success: linear-gradient(135deg, hsl(142 76% 42%), hsl(142 76% 52%));
    --gradient-warning: linear-gradient(135deg, hsl(25 95% 58%), hsl(25 95% 68%));
    --gradient-background: linear-gradient(135deg, hsl(220 20% 4%), hsl(220 20% 6%));
    
    --sidebar-background: 220 15% 10%;
    --sidebar-foreground: 220 15% 95%;
    --sidebar-primary: 210 100% 55%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 220 15% 15%;
    --sidebar-accent-foreground: 220 15% 95%;
    --sidebar-border: 220 15% 15%;
    --sidebar-ring: 210 100% 55%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    background: var(--gradient-background);
    min-height: 100vh;
    min-height: 100dvh;
    font-feature-settings: "rlig" 1, "calt" 1;
    /* iPhone touch optimizations */
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
    /* Smooth scrolling */
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
    /* Prevent zoom on input focus */
    touch-action: manipulation;
    /* Prevent horizontal scroll */
    overflow-x: hidden;
    /* Prevent overscroll bounce */
    overscroll-behavior: none;
    /* Ensure background covers all */
    background-attachment: fixed;
    background-size: cover;
  }

  /* Animated background particles */
  body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    height: 100dvh;
    background: 
      radial-gradient(circle at 20% 80%, hsl(210 100% 50% / 0.1) 0%, transparent 50%),
      radial-gradient(circle at 80% 20%, hsl(250 70% 60% / 0.1) 0%, transparent 50%),
      radial-gradient(circle at 40% 40%, hsl(142 76% 36% / 0.05) 0%, transparent 50%);
    pointer-events: none;
    z-index: -1;
  }

  /* PWA Safe Area Support */
  @supports (padding: max(0px)) {
    body {
      padding-top: max(env(safe-area-inset-top), 0px);
      padding-bottom: max(env(safe-area-inset-bottom), 0px);
      padding-left: max(env(safe-area-inset-left), 0px);
      padding-right: max(env(safe-area-inset-right), 0px);
    }
  }

  /* Scroll to top behavior */
  html {
    scroll-behavior: smooth;
  }

  /* Prevent overscroll */
  body {
    overscroll-behavior: none;
    overflow-x: hidden;
  }

  /* Container scroll management */
  .fullscreen-container {
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
    overscroll-behavior: none;
    position: relative;
    background: var(--gradient-background);
    background-attachment: fixed;
    background-size: cover;
  }

  /* Page content scroll management */
  .page-content {
    min-height: 100vh;
    min-height: 100dvh;
    overflow-x: hidden;
    overscroll-behavior: none;
    padding-bottom: 6rem; /* Space for bottom navigation */
    position: relative;
    background: transparent;
  }

  /* Additional overscroll prevention */
  html, body {
    overscroll-behavior: none;
    overflow-x: hidden;
    background: var(--gradient-background);
    background-attachment: fixed;
    background-size: cover;
  }

  /* Ensure all containers respect overscroll */
  * {
    overscroll-behavior: none;
  }

  /* JavaScript overscroll prevention */
  @media (display-mode: standalone) {
    /* Prevent overscroll with CSS */
    html, body {
      overscroll-behavior: none !important;
      overflow-x: hidden !important;
      -webkit-overflow-scrolling: auto !important;
      scroll-behavior: auto !important;
    }
    
    .fullscreen-container,
    .page-content,
    * {
      overscroll-behavior: none !important;
      -webkit-overflow-scrolling: auto !important;
    }
    
    /* Prevent bounce on iOS */
    body {
      position: fixed;
      width: 100%;
      height: 100%;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    /* Ensure content can scroll within fixed body */
    .fullscreen-container {
      height: 100vh;
      height: 100dvh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
  }

  /* Additional touch prevention */
  @media (hover: none) and (pointer: coarse) {
    html, body {
      overscroll-behavior: none !important;
      -webkit-overflow-scrolling: auto !important;
    }
    
    .fullscreen-container,
    .page-content {
      overscroll-behavior: none !important;
      -webkit-overflow-scrolling: auto !important;
    }
  }

  /* Fullscreen PWA adjustments */
  @media (display-mode: standalone) {
    body {
      padding-top: 0;
      padding-bottom: 0;
      padding-left: 0;
      padding-right: 0;
      min-height: 100vh;
      min-height: 100dvh;
    }
    
    .floating-nav {
      bottom: max(1.5rem, env(safe-area-inset-bottom));
    }
    
    .min-h-screen {
      min-height: 100vh;
      min-height: 100dvh;
    }

    /* Fullscreen container */
    .fullscreen-container {
      min-height: 100vh;
      min-height: 100dvh;
      position: relative;
      padding-top: env(safe-area-inset-top);
      padding-bottom: env(safe-area-inset-bottom);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      pointer-events: auto;
      z-index: 1;
    }
  }
}

@layer components {
  /* Liquid Glass Components */
  .liquid-glass {
    @apply backdrop-blur-2xl border border-white/30 shadow-2xl;
    background: hsl(var(--card-glass));
    border-color: hsl(var(--glass-border));
    box-shadow: 
      0 8px 32px hsl(var(--glass-shadow)),
      0 0 0 1px hsl(var(--glass-border));
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Hover effects only on desktop */
  @media (hover: hover) and (pointer: fine) {
    .liquid-glass:hover {
      box-shadow: 
        0 12px 40px hsl(var(--glass-shadow-hover)),
        0 0 0 1px hsl(var(--glass-border));
      transform: translateY(-2px);
    }
  }
  
  .liquid-button {
    @apply backdrop-blur-xl border border-white/25 shadow-xl transition-all duration-300;
    background: hsl(var(--glass-background));
    border-color: hsl(var(--glass-border));
    box-shadow: 
      0 4px 20px hsl(var(--glass-shadow)),
      0 0 0 1px hsl(var(--glass-border));
    /* Touch optimizations */
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    cursor: pointer;
  }
  
  /* Hover effects only on desktop */
  @media (hover: hover) and (pointer: fine) {
    .liquid-button:hover {
      @apply shadow-2xl;
      box-shadow: 
        0 8px 25px hsl(var(--glass-shadow-hover)),
        0 0 0 1px hsl(var(--glass-border));
      transform: translateY(-1px);
    }
  }

  /* Active state for touch devices */
  .liquid-button:active {
    transform: translateY(0);
    box-shadow: 
      0 2px 10px hsl(var(--glass-shadow)),
      0 0 0 1px hsl(var(--glass-border));
  }
  
  .liquid-input {
    @apply backdrop-blur-xl border border-white/25 bg-transparent transition-all duration-300;
    background: hsl(var(--input));
    border-color: hsl(var(--glass-border));
    box-shadow: 0 2px 10px hsl(var(--glass-shadow));
    /* iPhone input optimizations */
    font-size: 16px;
    -webkit-appearance: none;
    border-radius: var(--radius);
  }
  
  .liquid-input:focus {
    @apply shadow-lg;
    box-shadow: 
      0 4px 15px hsl(var(--glass-shadow-hover)),
      0 0 0 2px hsl(var(--ring));
    outline: none;
  }

  /* Focus transform only on desktop */
  @media (hover: hover) and (pointer: fine) {
    .liquid-input:focus {
      transform: translateY(-1px);
    }
  }

  /* Prevent zoom on iOS */
  @media screen and (max-width: 768px) {
    input, textarea, select {
      font-size: 16px !important;
    }
  }

  /* Floating bottom navigation */
  .floating-nav {
    @apply fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50;
    @apply liquid-glass px-8 py-4 rounded-full;
    animation: navFloat 6s ease-in-out infinite;
    pointer-events: auto;
    /* iPhone touch optimizations */
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    /* Ensure perfect centering */
    display: flex;
    justify-content: center;
    align-items: center;
    width: fit-content;
    min-width: max-content;
  }

  /* Hide labels on mobile */
  @media (max-width: 768px) {
    .floating-nav span {
      display: none;
    }
    
    .floating-nav {
      @apply px-6 py-3 bottom-8;
      /* Enhanced mobile centering */
      left: 50%;
      transform: translateX(-50%);
      width: auto;
      min-width: auto;
    }
  }

  /* iPhone specific optimizations */
  @supports (-webkit-touch-callout: none) {
    /* iOS Safari specific */
    .floating-nav {
      bottom: max(1.5rem, env(safe-area-inset-bottom));
      /* iOS centering fix */
      left: 50%;
      transform: translateX(-50%);
      width: auto;
      min-width: auto;
    }
    
    /* Larger touch targets for iOS */
    .liquid-button {
      min-height: 44px;
      min-width: 44px;
    }
    
    /* Prevent zoom on input focus */
    input, textarea, select {
      font-size: 16px;
    }

    /* Disable hover effects on touch devices */
    .liquid-glass:hover,
    .liquid-button:hover {
      transform: none;
      box-shadow: 
        0 8px 32px hsl(var(--glass-shadow)),
        0 0 0 1px hsl(var(--glass-border));
    }
  }

  /* Smooth animations */
  .animate-fade-in {
    animation: fadeIn 0.3s ease-out;
  }

  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }

  .animate-slide-down {
    animation: slideDown 0.3s ease-out;
  }

  .animate-scale-in {
    animation: scaleIn 0.2s ease-out;
  }

  .animate-bounce-subtle {
    animation: bounceSubtle 0.6s ease-out;
  }

  /* Balance gradient */
  .balance-gradient {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* Category gradients */
  .category-expense { background: var(--gradient-warning); }
  .category-income { background: var(--gradient-success); }
  .category-transfer { background: var(--gradient-primary); }
}

@layer utilities {
  /* Animation keyframes */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  @keyframes scaleIn {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  
  @keyframes bounceSubtle {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-3px);
    }
  }
  
  @keyframes navFloat {
    0%, 100% {
      transform: translateY(0);
    }
    50% {
      transform: translateY(-5px);
    }
  }

  /* Glass blur utilities */
  .glass-blur-sm { backdrop-filter: blur(8px); }
  .glass-blur-md { backdrop-filter: blur(12px); }
  .glass-blur-lg { backdrop-filter: blur(16px); }
  .glass-blur-xl { backdrop-filter: blur(24px); }
  .glass-blur-2xl { backdrop-filter: blur(40px); }
  
  /* Smooth transitions */
  .transition-smooth {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .transition-bounce {
    transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }

  /* Mobile scroll optimizations */
  .mobile-scroll {
    -webkit-overflow-scrolling: touch;
    scroll-behavior: smooth;
    touch-action: pan-y;
    overscroll-behavior: contain;
  }

  /* Enable natural scrolling on mobile */
  @media (max-width: 768px) {
    body {
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    .fullscreen-container {
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
  }

  /* Disable pointer events on hover elements for touch devices */
  @media (hover: none) and (pointer: coarse) {
    .liquid-glass:hover,
    .liquid-button:hover {
      transform: none !important;
      box-shadow: 
        0 8px 32px hsl(var(--glass-shadow)),
        0 0 0 1px hsl(var(--glass-border)) !important;
    }
  }

  /* Chart optimizations for mobile */
  @media (max-width: 768px) {
    .recharts-wrapper {
      width: 100% !important;
      height: 100% !important;
    }
    
    .recharts-surface {
      width: 100% !important;
      height: 100% !important;
    }
    
    /* Optimize chart container */
    .chart-container {
      width: 100%;
      padding: 0;
      margin: 0;
    }
    
    /* Reduce margins on mobile */
    .recharts-cartesian-axis-tick {
      font-size: 10px !important;
    }
    
    .recharts-cartesian-axis-label {
      font-size: 10px !important;
    }
    
    /* Sheet height optimization for mobile */
    [data-radix-dialog-content][data-side="bottom"] {
      height: 75vh !important;
      max-height: 75vh !important;
    }
  }
}